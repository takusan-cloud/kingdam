<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>ã‚­ãƒ³ã‚°ãƒ€ãƒ é ‚å¤©ã€€æ•°å­—åˆã‚ã›</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    table { border-collapse: collapse; margin: 10px 0; width: 100%; }
    td, th { border: 1px solid #ccc; padding: 4px; text-align: center; }
    input, select { font-size: 1em; padding: 4px; }
    button {
      padding: 12px 20px;
      font-size: 1.1em;
      border-radius: 10px;
      background: #0078d7;
      color: white;
      border: none;
      cursor: pointer;
      margin: 4px;
    }
    button:hover { background: #005fa3; }
    #result { margin-top: 1em; font-weight: bold; font-size: 1.3em; text-align: center; }
    .highlight { background-color: #90ee90; }
  </style>
</head>
<body>
  <h2>ã‚­ãƒ³ã‚°ãƒ€ãƒ é ‚å¤©ã€€æ•°å­—åˆã‚ã›</h2>

  <h3>æˆ¦åŠ›å…¥åŠ›</h3>
  <label>è¡¨ç¤ºã—ãŸã„æˆ¦åŠ›: <input id="totalPower" type="number" oninput="updateTarget()"></label><br>
  <label>ï¼—ä½“è¨­ç½®ã®æˆ¦åŠ›: <input id="usedPower" type="number" oninput="updateTarget()"></label><br>
  <label>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤: <input id="target" type="number" readonly></label><br>

  <h3>æ¨ã—ã‚­ãƒ£ãƒ©</h3>
  <label>æ¨ã—ã‚­ãƒ£ãƒ©ã‚’é¸æŠ:
    <select id="oshi">
      <option value="sawa">æ¾¤</option>
      <option value="heki">å£</option>
      <option value="kyoukai">ç¾Œç˜£</option>
      <option value="mouten">è’™æ¬</option>
    </select>
  </label>

  <br><br>
  <button onclick="checkCombinations()">ãƒã‚§ãƒƒã‚¯</button>
  <button onclick="resetInputs()">ãƒªã‚»ãƒƒãƒˆ</button>

  <h3>ãƒ¡ãƒ³ãƒãƒ¼å…¥åŠ›</h3>
  <table>
    <tr><th>A åå‰</th><th>A æ•°å­—</th><th>B åå‰</th><th>B æ•°å­—</th><th>C åå‰</th><th>C æ•°å­—</th></tr>
    <script>
      for(let i=1;i<=10;i++){
        document.write('<tr>'+
          `<td><input id="Aname${i}" type="text" ${i>1 ? 'disabled' : ''}></td><td><input id="A${i}" type="number"></td>`+
          `<td><input id="Bname${i}" type="text" ${i>1 ? 'disabled' : ''}></td><td><input id="B${i}" type="number"></td>`+
          `<td><input id="Cname${i}" type="text" ${i>1 ? 'disabled' : ''}></td><td><input id="C${i}" type="number"></td>`+
        '</tr>');
      }
    </script>
  </table>

  <h3>çµæœ</h3>
  <div id="result"></div>

<script>
// ğŸ”¹ ã‚­ãƒ£ãƒ©ã”ã¨ã®ã‚»ãƒªãƒ•
const serifs = {
  sawa: [
    "ç§ã®ä¼ã¯ä»Šã¾ã§ä¸€äººã‚‚æ­»ã‚“ã§ã„ã¾ã›ã‚“",
    "å¼±è€…ã«ã¯å¼±è€…ã®æˆ¦ã„æ–¹ãŒã‚ã‚Šã¾ã™",
    "ã“ã‚Œã¯å‘æ€¯ã§ã¯ãªãæˆ¦æ³•ã§ã™"
  ],
  heki: [
    "é ­ã‚’å†·ã‚„ã›é¦¬é¹¿è€…ã£",
    "ç›¾ã‚’æŠ•ã’ã‚‰ã‚ŒãŸæ„å‘³ãŒã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã‹ï¼ï¼",
    "ç§åŒæ§˜ã“ã®è»ã«ã¯æ´¾æ‰‹ã•ã¯ãªã„ ã ãŒã‚ã‚‰ã‚†ã‚‹åŸºæœ¬æˆ¦è¡“ã¯ä½•ç™¾å›ã¨ç¹°ã‚Šè¿”ã—ãŸ"
  ],
  kyoukai: [
    "ï½¥ï½¥ï½¥ã‚„ã£ã±ã‚Šå¤§ãƒã‚«ã ãªãŠå‰",
    "ç§ã‚‚å°†è»ã‚’ç›®æŒ‡ã™ãã€€ä¿¡",
    "èˆã†ãç·‘ç©‚"
  ],
  mouten: [
    "ã‚‚ã£ã¨æ°—æ¥½ã«è¡Œã“ãƒ¼ã‚ˆã€€å…ˆã¯é•·ã„ã‚“ã ã—",
    "ã‚ã‚ŠãŒã¨ã†ã€€ã˜ãƒ¼ã¡ã‚ƒã‚“",
    "ã‚„ã‚Œã‚‹ã®ã¯æ¥½è¯éšŠã ã‘ã€ã ã‹ã‚‰ã‚„ã‚‹"
  ]
};

// ğŸ”¹ å€¤ã®å–å¾—
function getValue(id){
  const val = Number(document.getElementById(id).value);
  return isNaN(val) ? 0 : val;
}
function getName(prefix){
  return document.getElementById(prefix+"name1").value || "ï¼Ÿï¼Ÿ";
}

// ğŸ”¹ ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚¯ãƒªã‚¢
function clearHighlights(){
  document.querySelectorAll("input").forEach(el=> el.classList.remove("highlight"));
}

// ğŸ”¹ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ›´æ–°
function updateTarget(){
  const total = getValue("totalPower");
  const used = getValue("usedPower");
  document.getElementById("target").value = total - used;
  saveData();
}

// ğŸ”¹ è¨ˆç®—ãƒã‚§ãƒƒã‚¯
function checkCombinations(){
  clearHighlights();
  const target = Number(document.getElementById('target').value);
  let found = null;

  for(let a=1;a<=10 && !found;a++){
    for(let b=1;b<=10 && !found;b++){
      for(let c=1;c<=10 && !found;c++){
        const idA = "A"+a, idB = "B"+b, idC = "C"+c;
        const valA = getValue(idA), valB = getValue(idB), valC = getValue(idC);
        const sum = valA + valB + valC;
        if(sum === target){
          found = { idA, idB, idC, valA, valB, valC, sum };
        }
      }
    }
  }

  const resDiv = document.getElementById('result');
  if(found){
    const nameA = getName("A"), nameB = getName("B"), nameC = getName("C");
    const oshiKey = document.getElementById("oshi").value;
    const oshiName = document.querySelector(`#oshi option[value="${oshiKey}"]`).textContent;
    const lines = serifs[oshiKey];
    const line = lines[Math.floor(Math.random()*lines.length)];

    resDiv.textContent = `ğŸ‰ ${oshiName}ã€Œ${line}ã€ (${nameA}(${found.valA}) + ${nameB}(${found.valB}) + ${nameC}(${found.valC}) = ${found.sum})`;
    resDiv.style.color = "green";
    document.getElementById(found.idA).classList.add("highlight");
    document.getElementById(found.idB).classList.add("highlight");
    document.getElementById(found.idC).classList.add("highlight");
  } else {
    resDiv.textContent = "çµ„ã¿åˆã‚ã›ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚";
    resDiv.style.color = "red";
  }
  saveData();
}

// ğŸ”¹ å…¥åŠ›ä¿å­˜
function saveData(){
  let data = {
    total: document.getElementById("totalPower").value,
    used: document.getElementById("usedPower").value,
    oshi: document.getElementById("oshi").value
  };
  ["A","B","C"].forEach(col=>{
    data[col+"name"] = document.getElementById(col+"name1").value;
    for(let i=1;i<=10;i++){
      data[col+i] = document.getElementById(col+i).value;
    }
  });
  localStorage.setItem("kingdomTool", JSON.stringify(data));
}

// ğŸ”¹ å…¥åŠ›å¾©å…ƒ
function loadData(){
  const saved = localStorage.getItem("kingdomTool");
  if(saved){
    const data = JSON.parse(saved);
    document.getElementById("totalPower").value = data.total || "";
    document.getElementById("usedPower").value = data.used || "";
    document.getElementById("oshi").value = data.oshi || "sawa";
    ["A","B","C"].forEach(col=>{
      document.getElementById(col+"name1").value = data[col+"name"] || "";
      for(let i=1;i<=10;i++){
        document.getElementById(col+i).value = data[col+i] || "";
      }
    });
    updateTarget();
  }
}

// ğŸ”¹ ãƒªã‚»ãƒƒãƒˆ
function resetInputs(){
  localStorage.removeItem("kingdomTool");
  document.querySelectorAll("input").forEach(el=> { el.value=""; });
  document.getElementById("result").textContent = "";
}

// åˆæœŸãƒ­ãƒ¼ãƒ‰
window.onload = loadData;
</script>
</body>
</html>
